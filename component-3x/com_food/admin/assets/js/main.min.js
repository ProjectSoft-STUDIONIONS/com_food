!function(e){const t=e.noConflict(!0);let o=location.search.replace(/\?/g,"").split("&").map((e,t,o)=>{return e.split("=")});const n=Object.fromEntries(o),a=parseInt(window.MAX_COUNT_FILE),r=function(){let t=document.form_mode,o=e("input[name=mode]",t)[0],n=e("input[name=file]",t)[0],a=e("input[name=new_file]",t)[0];o.value="",n.value="",a.value="",t.reset()},s=function(e,t,o){let n=-1;for(o||0===o||(o=" "),t-=(e=String(e)).length;++n<t;)e=o+e;return e};if(window.uploadFiles=function(e){let o=t("#p_uploads"),n=[...e.files],r=[];if(n.length>a)return alert(`\u041d\u0435\u043b\u044c\u0437\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 ${a} \u0444\u0430\u0439\u043b\u043e\u0432`),document.upload.reset(),!1;for(let e of n){let t;if(null!==(t=/[^.]+$/.exec(e.name))){let n=t[0].toLowerCase();if("xlsx"!=n&&"pdf"!=n)return o.html(""),alert(`\u041d\u0435\u043b\u044c\u0437\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0439 \u0442\u0438\u043f \u0444\u0430\u0439\u043b\u0430!\n${e.name} - ${e.type}`),document.upload.reset(),!1;r.push(e.name)}}return o.html(r.join("<br>")),!1},window.modeFile=function(t){let o=e(t).data("mode"),n=e(t).data("file"),a=document.form_mode,s=e("input[name=mode]",a)[0],i=e("input[name=file]",a)[0],l=e("input[name=new_file]",a)[0];switch(o){case"rename":const[...e]=n.split("."),t=e.pop();let c=e.join("."),p=prompt(sprintf(window.com_food_lang.COM_FOOD_RENAME_QUAERE,n),c);if(!p)return r(),!1;if(/[^A-z0-9-._]+/.test(p))return alert(window.com_food_lang.COM_FOOD_RENAME_ERROR+"!"),r(),!1;s.value=o,i.value=n,l.value=p+`.${t}`,i.value!=l.value?a.submit():r();break;case"delete":confirm(sprintf(window.com_food_lang.COM_FOOD_DELETE_QUAERE,n))&&(s.value=o,i.value=n,a.submit())}},n.dir){const t=`${location.origin}/${n.dir}/`;e.extend(!0,DataTable.Buttons.defaults,{dom:{container:{className:"dt-buttons btn-group flex-wrap"},button:{className:"btn btn-secondary text-uppercase"}}});new DataTable(".food-table .table",{columns:[{name:"file"},{name:"permission"},{name:"date"},{name:"size"},{name:"actions"}],columnDefs:[{searchable:!0,targets:[0],orderable:!0},{searchable:!1,targets:[1,2,3,4],orderable:!1}],ordering:!0,stateSave:!0,stateSaveCallback:function(e,t){localStorage.setItem("DataTables_"+e.sInstance+"_"+n.dir,JSON.stringify(t))},stateLoadCallback:function(e){return JSON.parse(localStorage.getItem("DataTables_"+e.sInstance+"_"+n.dir))},lengthMenu:[[10,25,50,100,-1],["\u043f\u043e 10","\u043f\u043e 25","\u043f\u043e 50","\u043f\u043e 100","\u0412\u0441\u0435"]],layout:{topStart:["pageLength","search"],topEnd:{buttons:[{extend:"excel",text:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442 \u0432 XLSX",download:"",filename:`\u042d\u043a\u0441\u043f\u043e\u0440\u0442 ${n.dir} \u0432 XLSX`,title:`\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f ${t}`,sheetName:`${n.dir}`,customize:function(o){let a=(new Date).toISOString();o._rels={},o._rels[".rels"]=e.parseXML('<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>'),o.docProps={},o.docProps["core.xml"]=e.parseXML('<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">'+`<dc:title>\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f ${t}</dc:title>`+`<dc:subject>\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f ${t}</dc:subject>`+`<dc:creator>${componentName}</dc:creator>`+"<cp:keywords />"+`<dc:description>${componentName}</dc:description>`+`<cp:lastModifiedBy>${componentName}</cp:lastModifiedBy>`+`<dcterms:created xsi:type="dcterms:W3CDTF">${a}</dcterms:created>`+`<dcterms:modified xsi:type="dcterms:W3CDTF">${a}</dcterms:modified>`+`<cp:category>${n.dir}</cp:category>`+"</cp:coreProperties>"),o.docProps["app.xml"]=e.parseXML('<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>Microsoft Excel</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>\u041b\u0438\u0441\u0442\u044b</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="1" baseType="lpstr">'+`<vt:lpstr>${n.dir}</vt:lpstr>`+"</vt:vector></TitlesOfParts>"+`<Manager>${userName}</Manager>`+`<Company>${userName}</Company>`+"<LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc>"+`<HyperlinkBase>${t}</HyperlinkBase>`+"<HyperlinksChanged>false</HyperlinksChanged><AppVersion>16.0300</AppVersion></Properties>");let r=o["[Content_Types].xml"],s=r.querySelector("Types"),i=r.createElement("Override");i.setAttribute("PartName","/docProps/core.xml"),i.setAttribute("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),s.append(i);let l=r.createElement("Override");l.setAttribute("PartName","/docProps/app.xml"),l.setAttribute("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),s.append(l),o["[Content_Types].xml"]=r},action:function(e,t,o,n,a){DataTable.ext.buttons.excelHtml5.action.call(this,e,t,o,n,a)}},{extend:"pdf",text:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442 \u0432 PDF",download:"",filename:`\u042d\u043a\u0441\u043f\u043e\u0440\u0442 ${n.dir} \u0432 PDF`,title:`\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f ${t}`,customize:function(e){let o=(new Date).toISOString(),n=["\u041c\u0435\u043d\u044e \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u043e\u0433\u043e \u043f\u0438\u0442\u0430\u043d\u0438\u044f.",`\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f ${t}`];e.language="ru-RU",e.info={title:n.join(" "),author:componentName,subject:n.join(" "),keywords:n.join(" "),creator:`${componentName}`,producer:`${userName}`,modDate:`${o}`},e.header={columns:[{text:`${t}`,margin:[15,15,15,15],alignment:"left"},{text:function(e=0){let t=new Date(e),o=t.getDate(),n=t.getMonth()+1,a=t.getFullYear(),r=t.getHours(),i=t.getMinutes(),l=t.getSeconds(),c=[s(o,2,"0"),s(n,2,"0"),String(a)],p=[s(r,2,"0"),s(i,2,"0"),s(l,2,"0")];return c.join("-")+" "+p.join(":")}((new Date).getTime()),margin:[15,15,15,15],alignment:"right"}]},e.footer=function(e,t){return[{text:e.toString()+" \u0438\u0437 "+t,margin:[15,15,15,15],alignment:"center"}]},e.content[0].text=n.join("\r\n")},action:function(e,t,o,n,a){DataTable.ext.buttons.pdfHtml5.action.call(this,e,t,o,n,a)}}]}},language:{url:"/administrator/components/com_food/assets/js/ru_RU.json"}})}}(jQuery);